_target_: llm4rec_pytorch_simple.data.rec_dataset.RecoDataModule
max_hash_ranges:
  genres: 63
  title: 16383
  year: 511
data_path: ${paths.data_dir}
max_jagged_dimension: 16
max_sequence_length: 200     # 最大序列长度 (199 历史 + 1 输出)
num_items: 3884              # 物品总数 (3883 部电影 + 1 for padding)
chronological: True
batch_size: 128
sample_ratio: 1.0
num_workers: 4
prefetch_factor: 4

split_mode: "user_id" # 数据集按时间划分方式： global 全局划分，user 基于用户的划分，user_id 基于用户ID的划分

data_prepare:
  _target_: llm4rec_pytorch_simple.data.prepare_data.PrepareDataMovieLens
  data_dir: ${paths.data_dir}
  max_hash_ranges: ${data.max_hash_ranges}

train_dataset:
  _target_: llm4rec_pytorch_simple.data.rec_dataset.RecDataset
  ratings_file: "${paths.root_dir}/ml-1m/processed/sasrec_format_${data.split_mode}_train_data.csv"
  ignore_last_n: 1  # 训练集:最后1个作为目标，这样那output就要是1

val_dataset:
  _target_: llm4rec_pytorch_simple.data.rec_dataset.RecDataset
  ratings_file: "${paths.root_dir}/ml-1m/processed/sasrec_format_${data.split_mode}_test_data.csv"
  ignore_last_n: 1  # 验证集:最后1个作为目标(用于调参)

test_dataset:
  _target_: llm4rec_pytorch_simple.data.rec_dataset.RecDataset
  ratings_file: "${paths.root_dir}/ml-1m/processed/sasrec_format_${data.split_mode}_test_data.csv"
  ignore_last_n: 0
